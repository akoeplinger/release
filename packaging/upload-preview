#!/bin/sh

BUNDLE="PRE-RELEASE"
TARGET_USER="mono-web"
TARGET_HOST="mono.ximian.com"

BASE_DIR="~/release/monobuild/www/preview"
BASE_URL="/monobuild/preview"

ssh $TARGET_USER@$TARGET_HOST "mkdir -p $BASE_DIR"
cd ../website
# Need skip missing, because we don't build packages for gnome-sharp and gtk-sharp 2.10 yet... but we still want to publish the sources
./sync-bundle.py --skip_missing $BUNDLE $TARGET_USER@$TARGET_HOST:$BASE_DIR

scp packaging.css $TARGET_USER@$TARGET_HOST:$BASE_DIR
ssh $TARGET_USER@$TARGET_HOST "cd release/website; ./mk-sources-index.py           $BUNDLE $BASE_DIR $BASE_URL $BASE_DIR/sources"
ssh $TARGET_USER@$TARGET_HOST "cd release/website; ./mk-distro-index.py --skip_zip $BUNDLE $BASE_DIR $BASE_URL $BASE_DIR/packages $TARGET_HOST"
ssh $TARGET_USER@$TARGET_HOST "cd release/website; ./mk-archive-index.py           $BUNDLE $BASE_DIR $BASE_URL"
ssh $TARGET_USER@$TARGET_HOST "cd release/website; ./mk-repos.py                   $BUNDLE $BASE_DIR $BASE_URL $BASE_DIR/packages $TARGET_HOST"

