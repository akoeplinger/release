#!/bin/sh

BUNDLE="PRE-RELEASE"
TARGET_USER="mono-web"
TARGET_HOST="mono.ximian.com"

BASE_DIR="~/release/monobuild/www/preview"
BASE_URL="/monobuild/preview"

ssh $TARGET_USER@$TARGET_HOST "mkdir -p $BASE_DIR"
cd ../website
./sync-bundle.py $BUNDLE $TARGET_USER@$TARGET_HOST:$BASE_DIR || exit 1

scp packaging.css $TARGET_USER@$TARGET_HOST:$BASE_DIR
ssh $TARGET_USER@$TARGET_HOST "cd release/website; ./mk-sources-index.py           $BUNDLE $BASE_DIR $BASE_URL $BASE_DIR/sources"			|| exit 1
ssh $TARGET_USER@$TARGET_HOST "cd release/website; ./mk-distro-index.py --skip_zip $BUNDLE $BASE_DIR $BASE_URL $BASE_DIR/packages $TARGET_HOST"		|| exit 1
ssh $TARGET_USER@$TARGET_HOST "cd release/website; ./mk-archive-index.py           $BUNDLE $BASE_DIR $BASE_URL"						|| exit 1
ssh $TARGET_USER@$TARGET_HOST "cd release/website; ./mk-repos.py                   $BUNDLE $BASE_DIR $BASE_URL $BASE_DIR/packages $TARGET_HOST"		|| exit 1

