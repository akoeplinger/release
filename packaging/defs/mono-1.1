# Possibly use sles-8 as the new base distro?
BUILD_HOSTS=(
	redhat-9-i386
	sles-9-x86_64
	sles-9-ia64
	sles-9-s390
	sles-9-s390x
	sunos-8-sparc
	win-4-i386
)

USE_HOSTS=(
	fedora-3-i386
	fedora-4-i386
	fedora-4-x86_64
	nld-9-i586
	nld-9-x86_64
	redhat-9-i386
	rhel-3-i386
	rhel-4-i386
	sles-9-i586
	sles-9-ia64
	sles-9-s390
	sles-9-s390x
	sles-9-x86_64
	sunos-8-sparc
	suse-92-i586
	suse-93-i586
	suse-93-x86_64
	suse-100-i586
	suse-100-x86_64
	win-4-i386
)

# Having this ensures that the wrong mono isn't in the jail
#  (Or that mono is present for the snapshot builds)
MONO_DEPS=(
#	mono-1.1
)


## format: <$DISTRO>_ZIP_DEPS
# Note: $DISTRO must have the hyphens converted to underscores
win_4_i386_ZIP_DEPS=(
	ftp://ftp.gtk.org/pub/gtk/v2.6/win32/glib-2.6.6.zip
	ftp://ftp.gtk.org/pub/gtk/v2.6/win32/glib-dev-2.6.6.zip
	http://www.gimp.org/~tml/gimp/win32/pkgconfig-0.15.zip
	http://www.gimp.org/~tml/gimp/win32/libiconv-1.9.1.bin.woe32.zip
	http://www.gimp.org/~tml/gimp/win32/gettext-0.14.5.zip
	http://www.gimp.org/~tml/gimp/win32/gettext-dev-0.14.5.zip

	# Old library
	#http://www.gimp.org/~tml/gimp/win32/gettext-runtime-0.13.1.zip
)

sunos_8_sparc_ZIP_DEPS=(

#	# Repackaged Sunfreeware packages
#	http://primates.ximian.com/~wberrier/sunos/deps/sunfreeware/sunos-8-sparc/expat-1.95.5-0.sunos8.sparc.zip
#	http://primates.ximian.com/~wberrier/sunos/deps/sunfreeware/sunos-8-sparc/gettext-0.14.1-0-sunos8.sparc.zip
#	http://primates.ximian.com/~wberrier/sunos/deps/sunfreeware/sunos-8-sparc/glib-2.3.3-0-sunos8.sparc.zip
#	http://primates.ximian.com/~wberrier/sunos/deps/sunfreeware/sunos-8-sparc/libiconv-1.8-0-sunos8.sparc.zip
#	http://primates.ximian.com/~wberrier/sunos/deps/sunfreeware/sunos-8-sparc/libintl-3.4.0-0-sunos8.sparc.zip
#	http://primates.ximian.com/~wberrier/sunos/deps/sunfreeware/sunos-8-sparc/pkgconfig-0.15.0-0-sunos8.sparc.zip


#	# Self Compiled versions
#	# gettext also comes with libintl
#	http://primates.ximian.com/~wberrier/sunos/deps/novell/gettext-0.14.5-0.sunos8.novell.sparc.zip
#	http://primates.ximian.com/~wberrier/sunos/deps/novell/libiconv-1.9.1-0.sunos8.novell.sparc.zip
#	http://primates.ximian.com/~wberrier/sunos/deps/novell/glib-2.8.3-0.sunos8.novell.sparc.zip
#	http://primates.ximian.com/~wberrier/sunos/deps-novell/pkg-config-0.20-0.sunos8.novell.sparc.zip
#
#	# Repackaged
#	http://primates.ximian.com/~wberrier/sunos/deps-novell/libgcc-3.3-0.sunos8.novell.sparc.zip

#
#	# Sunfreeware packages
	#ftp://sunfreeware.mirrors.tds.net/pub/sunfreeware/sparc/5.8/libgcc-3.3-sol8-sparc-local.gz
	# Have to use this one because above is not under $prefix/lib
	# TODO: This packages doesn't have symbolic links, is this ok?
	http://primates.ximian.com/~wberrier/sunos/deps/sunfreeware/sunos-8-sparc/libgcc-3.3-0-sunos8.sparc.zip

	# 2.6.2 glib is missing a header file
	#ftp://sunfreeware.mirrors.tds.net/pub/sunfreeware/sparc/5.8/glib-2.6.2-sol8-sparc-local.gz
	ftp://sunfreeware.mirrors.tds.net/pub/sunfreeware/sparc/5.8/glib-2.2.3-sol8-sparc-local.gz 

	# Gettext needs expat
	ftp://sunfreeware.mirrors.tds.net/pub/sunfreeware/sparc/5.8/gettext-0.14.1-sol8-sparc-local.gz
	ftp://sunfreeware.mirrors.tds.net/pub/sunfreeware/sparc/5.8/expat-1.95.5-sol8-sparc-local.gz
	ftp://sunfreeware.mirrors.tds.net/pub/sunfreeware/sparc/5.8/libiconv-1.8-sol8-sparc-local.gz

	# Most packages need this
	ftp://sunfreeware.mirrors.tds.net/pub/sunfreeware/sparc/5.8/libintl-3.4.0-sol8-sparc-local.gz 

	ftp://sunfreeware.mirrors.tds.net/pub/sunfreeware/sparc/5.8/pkgconfig-0.15.0-sol8-sparc-local.gz

	# Random generator for crypto
	# The other option is to require: a sun patch (http://www.cosy.sbg.ac.at/~andi/SUNrand/)
	# For sunos8sparc, it's patch 112438
	#ftp://sunfreeware.mirrors.tds.net/pub/sunfreeware/sparc/5.8/egd-0.8-sol8-sparc-local.gz
	# Egd won't work here... users must use the patch

	# For testing...
	#ftp://sunfreeware.mirrors.tds.net/pub/sunfreeware/sparc/5.8/gdb-6.0-sol8-sparc-local.gz
)

sunos_8_sparc_ZIP_BUILD () {
	# Bison fails without the M4 var (tries to use /usr/ccs/bin/m4 instead otherwise)

	# Only if a non-gnu m4 is in the path
	export M4=/usr/local/bin/m4

	# Do this to make sure libgcc is found.  Won't be needed when we install libgcc into build_deps
	#export LD_LIBRARY_PATH=/usr/local/lib:$LD_LIBRARY_PATH

	# Relocation on solaris is causing problems... if we're going to have to use /opt/mono as a prefix,
		# Big changes are going to be needed
	
	./configure --prefix=/tmp/install
	make || exit 1
	# Cannot find ELF
	# Gnu Strip causes problems on Solaris
	#  (http://sunportal.sunmanagers.org/pipermail/summaries/2003-August/004247.html)
	# This is fixed in a later bintuils release... is this enough reason to use blastwave packages?
	#make install-strip || exit 1
	make install || exit 1

	# Make sure to use the solaris version of strip
	cd /tmp/install/lib
	/usr/ccs/bin/strip * || true
	cd /tmp/install/bin
	/usr/ccs/bin/strip * || true
}

win_4_i386_ZIP_BUILD () {

	# Only needed for boot strapping
	#export PATH=$PATH:/cygdrive/c/mono/Mono-1.1.8.3/bin

	./configure --prefix=/tmp/install

	# Hacks to get it to build 

	make || exit 1
	#make check
	make install || exit 1

	cd /tmp/install/bin
	strip --strip-unneeded *.dll *.exe

	cd /tmp/install/lib
	strip --strip-unneeded *.a


}

get_destroot () {
	# rh9 rpms can't be used on sles-8-i386
	if [ $DISTRO == "sles-8-i386" ] ; then
		DEST_ROOT=$DISTRO
	elif [ x$USE_ZIP_PKG != x ] ; then
		DEST_ROOT=$DISTRO
	else
		DEST_ROOT=$ARCH
	fi
}

HEAD_PATH="trunk"
RELEASE_PATH="tags/mono-[[version]]"

get_tarball () {
	msvn_tar $1
}

