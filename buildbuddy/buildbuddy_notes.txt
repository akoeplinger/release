#############################################
#  Build RPM package of bb:
#############################################

# Check out the source
svn co https://forgesvn1.novell.com/svn/ximian-bb/branches/bb-1.6/bb

# Create the tarball
# Get the version from META.yml
cd $HOME/wa/bb
export VERSION=1.6.4
rm -Rf bb-$VERSION*
svn export . bb-$VERSION ; tar -pzcvf bb-$VERSION.tar.gz bb-$VERSION

# Copy it to the rpm sources location (/usr/src/redhat since we're on a legacy
# fedora box)
sudo cp bb-$VERSION.tar.gz /usr/src/redhat/SOURCES

# Remove previous rpms
sudo rm /usr/src/*/RPMS/noarch/build-buddy*

cd $HOME/wa/msvn/release/buildbuddy
sudo rpmbuild -bb build-buddy.spec

cp /usr/src/*/RPMS/noarch/build-buddy* .


# You can then install the rpm, 
# but you'll have to manually install some perl modules (XML::Simple)
# The provides are not in the rpm's specfile so that we can use this rpm
#  on all distros

# Then: ximian-build-system-config-0.5-0.ximian.5.1.i386.rpm in this directory 
#  (not checked in)
# contains necessary ssh keys

# To install build-buddy rpm to all rpm distros:
./push_build_buddy all
# (this will also install ximian-build-system-config to distros needing to
# check out)

